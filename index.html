<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dopravní Informace</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        form {
            max-width: 600px;
            margin: auto;
        }
    </style>
</head>
<body>

    <header>
        <h1>Dopravní Informace a Hlídky</h1>
    </header>

    <section>
        <h2>Záznam Dopravní Situace</h2>
        <form>
            <label for="location">Lokace:</label>
            <input type="text" id="location" name="location" required>

            <label for="description">Popis situace:</label>
            <textarea id="description" name="description" required></textarea>

            <label for="police_presence">Policie přítomna:</label>
            <select id="police_presence" name="police_presence">
                <option value="yes">Ano</option>
                <option value="no">Ne</option>
            </select>

            <label for="date">Datum:</label>
            <input type="date" id="date" name="date" required>

            <label for="time">Čas:</label>
            <input type="time" id="time" name="time" required>

            <button type="button" id="submitButton">Odeslat</button>
        </form>
    </section>

    <section>
        <h2>Seznam Záznamů</h2>
        <ul id="recordList"></ul>
    </section>

    <footer>
        <p>&copy; 2024 Dopravní Informace</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCMXz0EgG-_pHTwnNdNyl2cq2aLStrLSYM",
            authDomain: "dopravnisituace-1e008.firebaseapp.com",
            projectId: "dopravnisituace-1e008",
            databaseURL: "https://dopravnisituace-1e008-default-rtdb.europe-west1.firebasedatabase.app",
            storageBucket: "dopravnisituace-1e008.appspot.com",
            messagingSenderId: "964028265248",
            appId: "1:964028265248:web:f1f5daf1ea21065c6bdd45",
            measurementId: "G-TE265RZDY3"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        function submitForm() {
            const location = document.getElementById('location').value;
            const description = document.getElementById('description').value;
            const policePresence = document.getElementById('police_presence').value;
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;

            const recordsRef = ref(database, 'records');
            push(recordsRef, {
                location,
                description,
                policePresence,
                date,
                time,
            });

            getRecords();
        }

        function getRecords() {
            const recordsRef = ref(database, 'records');
            onValue(recordsRef, (snapshot) => {
                const records = [];
                snapshot.forEach((childSnapshot) => {
                    records.push(childSnapshot.val());
                });

                const recordList = document.getElementById('recordList');
                recordList.innerHTML = '';

                records.forEach((record) => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${record.date} ${record.time} - ${record.location}, ${record.description} (Policie přítomna: ${record.policePresence})`;
                    recordList.appendChild(listItem);
                });
            });
        }

        document.getElementById('submitButton').addEventListener('click', submitForm);

        document.addEventListener("DOMContentLoaded", function() {
            getRecords();
        });
    </script>
</body>
</html>
